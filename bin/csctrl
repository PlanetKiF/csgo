#!/bin/bash

CSOWNER=%CSGO_USERNAME%
CSGODIR=/home/${CSOWNER}/csgosv

start() {
    # code to start app comes here
    # example: daemon program_name &
    #${CSGODIR}/srcds_run -game csgo +game_type 0 +game_mode 0 -tickrate 128 -usercon +mapgroup mg_active +map cs_office -pidfile ${CSGODIR}/csgosv.pid
    #${CSGODIR}/srcds_run -game csgo +game_type 0 +game_mode 0 -tickrate 128 -usercon +mapgroup mg_active +host_workshop_map 125444404 -pidfile ${CSGODIR}/csgosv.pid
    #Ciske: +vars verschoben autoexec.cfg, -hltv hinzugef√ºgt
    ${CSGODIR}/srcds_run -game csgo -usercon -hltv +mapgroup mg_active +host_workshop_map 125444404 -pidfile ${CSGODIR}/csgosv.pid
}

stop() {
    # code to stop app comes here
    # example: killproc program_name
    steamcmd +login anonymous +force_install_dir ${CSGODIR}  +app_stop 740 +quit
}

killer() {
   if [ "x$1" = "x-f" ];
     then killall -9 srcds_linux srcds_run
     else kill -9 $(cat ${CSGODIR}/csgosv.pid) # but will restart
  fi
}

case "$1" in
    start)
       start
       ;;
    #stop)
    #   stop
    #   ;;
    kill)
       killer $2
       ;;
    restart)
       stop
       killer
       # start # cs restarts automatically in case of a kill
       ;;
    status)
       # code to check status of app comes here
       # example: status program_name
       steamcmd +login anonymous +force_install_dir ${CSGODIR} +app_status 740 +quit
       ;;
    update)
       # code to check status of app comes here
       # example: status program_name
       steamcmd +login anonymous +force_install_dir ${CSGODIR} +app_update 740 +quit
       ;;
    *)
       echo "Usage: $0 {start|restart|status|update}"
esac

exit 0
